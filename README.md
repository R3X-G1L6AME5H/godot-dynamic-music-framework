# Godot Dynamic Music Framework
## What is this?
It is a Godot plugin for dynamic music. It was designed to add dynamics to the game soundtrack. If you're looking for a tool that can mix and blend between track depending on the ingame variables, I got you. If you're looking for a tool that can play musical motifs randomly in the track, I got you. If you need a way to sync your game with the music in the background without headaches, I got you. 

What does the workflow look like? Open your favourite DAW. Make your music. Export your tracks and midi's to your project's asset directory. Use the Playlist Generator to quickly and intuitively organize your music in a way the plugin will understand. Organize your sound buses. Wire up your scripts to the `MusicController`'s signals. And bada-bing bada-boom, all is good.

## Usage
There is quite a bit to go through so the usage will be explained through an example; a real-life use case for this plugin.


## Act I - Boops and Beeps
Before we can even start talking about the plugin we must first talk about the music itself. There are certain things to keep in mind when composing for your game. Its a matter of structure. 

![Music Structure]()
One section must blend well into another, to allow for horizontal mixing. Each track must sound good alone, and in combination with every other track to allow for vertical mixing. You may thow a few melodical phrases in as well, with intention to have them randomly play in your game. And lastly, you will wish to write down some midi that will play no sound, but will instead function as a syncronizing medium.
* The making of the soundtrack(what to keep in mind)
* the exporting

## Act II - Organizing the goods
* the nodes explained and visualized

## Act III - The Conductor
* how to set up your scene(bus layout)
* wiring up the signals


This plugin is composed of 3 parts in total. The `MusicController`, the `Blackboard`, and the PlaylistGenerator. The `MusicController` and the `Blackboard` are singletons, meaning that they are available from anywhere within the project. 

The `Blackboard` is ment to store all the states going on in-game and make that data accessible by every script in the project. 

The `MusicController` is the thing that plays all the sounds. It will read the `Blackboard`, and adapt how, and what it plays all according to its setup in the `Library.tres` file. `Library.tres` is generated by the PlaylistGenerator component. 



### PlaylistGenerator
PlaylistGenerator is made up of many smaller nodes which simplify the organization of all the files, and settings. At the top of all the nodes is the `DMFPlaylistGenerator` node aka. the Generator. If you select it, you will see that this node has a singular property: toggle. When pressed, it will generate `res://Library.gd` file. Second is the `DMFSong` node. This node defines all the songs available to the `MusicController`. Here you will define the song's BPM and its Time Signature. 

#### Tracks
Lastly, there come the nodes you'll spend most of your time with. First lets talk about the `DMFTrack` node. It's job is to play a sound file; simple as. 

#### Segments
Next up is the `DMFSegment` node. One thing you should familiarize yourself with is the concept of bars. Bars are a certain time frame of music. It is calculated using the BPM, and the Time Signature specified in `DMFSong` node. Otherwise, it is very easy to use. Specify FROM which TO which bar a segment will span. )Insert example( Later on, you will be able to switch from one segment to the next, making your game music more dynamic. 

#### Oneshots
Speaking of dynamic, I introduce you to `DMFOneshot` node. Oneshots have a certain chance of playing any time the song loops back to them. This can add spice to your music. What I call "Oneshots" is what Mick Gordon used on his Doom OST. Making a few riffs which would play randomly throught the song. 

#### Watchdogs
`DMFWatchdog` is where things get crazy. The jist of is: you select a track, one of ITS properties, one of the WORLD's properties, WORLD property's max value, and a graph of how it should respond. Imagine it this way: The game starts and you have this piano track playing. The player gets hit, and the health drops bellow 50%. Along with it, the piano gets quieter, and a violin fades in. How? Watchdogs. You start with two tracks: the piano and the violin. Then you make two watchdogs. You make one watchdog target the piano track, and the other one target the violin track. You tell them their `Current Property` is "PlayerHP", and that the `Property Max` is "PlayerHPMax"(both of which must be available in the Blackboard), and to `Change Property` Volume. Lastly, you create the new curves for the `Change Graph`. One whose value is high above 50%, and one whose value is high BELOW 50%. That is how you get the example above. 

#### Midi's
And then there is the `DMFMidi` node. This node is intended to syncronize the music and the bahaviour in game. Up until this point, the music reacted to the player, but here on out the player reacts to the music. Any game which has a rhythm element to it can benefit from this node. The idea is to use your favourite DAW to create a midi file in line with the music being played, each note coresponding to a certain behaviour. Say, in a guitar hero like game, you could map the RED button to note C2, BLUE button to note D2, and the YELLOW button to note E2. The `MusicController` will process this midi file alongside the track file, and emit signals when a note is on, and when its off. Since the `MusicController` is a singleton, you can connect any object to it by simply writing `MusicController.connect("note_on", self, "_on_Node_note_on")`, and `MusicController.connect("note_off", self, "_on_Node_note_off")`(This assumes that you know how connecting signals works). There is no end to what you can do with this functionality.


```
Generator
\--Song
   \-- Tracks
   \-- Segments
   \-- Oneshots
   \-- Watchdogs
   \-- Midi's
   
```

### Blackboard
### MusicController

## TO DO
These are some of the things that will probably interupt my game development.
- Get rid of the `Library.gd` and replace it with `Library.tres`. Far more efficient.
- Add transitions. There is currently no way to hop between segments, or songs.
- Give Watchdogs more properties they can influence e.g. Filters, Panning, Overdrive, Flanger, etc.
